import{b as G,g as T,s as E,P as X,a as i,u as z,f as F,_ as x,j as t,i as L,k as U,r as f,M as k,I as C,w as j,B as O,t as Y,v as Z,C as ee,R as te,S as se}from"./index-r_yxv9AL.js";import{T as v}from"./TextField-KyvZr_kk.js";import{D as oe}from"./DataGrid-_mhzC7gF.js";import"./Checkbox-C-VidIdO.js";function ne(o){return G("MuiCard",o)}T("MuiCard",["root"]);const re=["className","raised"],ae=o=>{const{classes:e}=o;return U({root:["root"]},ne,e)},ie=E(X,{name:"MuiCard",slot:"Root",overridesResolver:(o,e)=>e.root})(()=>({overflow:"hidden"})),ce=i.forwardRef(function(e,n){const r=z({props:e,name:"MuiCard"}),{className:l,raised:a=!1}=r,b=F(r,re),d=x({},r,{raised:a}),p=ae(d);return t.jsx(ie,x({className:L(p.root,l),elevation:a?8:void 0,ref:n,ownerState:d},b))}),le=ce;function ue(o){return G("MuiCardContent",o)}T("MuiCardContent",["root"]);const de=["className","component"],pe=o=>{const{classes:e}=o;return U({root:["root"]},ue,e)},me=E("div",{name:"MuiCardContent",slot:"Root",overridesResolver:(o,e)=>e.root})(()=>({padding:16,"&:last-child":{paddingBottom:24}})),be=i.forwardRef(function(e,n){const r=z({props:e,name:"MuiCardContent"}),{className:l,component:a="div"}=r,b=F(r,de),d=x({},r,{component:a}),p=pe(d);return t.jsx(me,x({as:a,className:L(p.root,l),ownerState:d,ref:n},b))}),Se=be,ge={stkrubro:[],stkgrupos:[],idStkGrupo:"",idStkRubro:"",datositems:[],totaling:0,SalDisDP:"P"},xe="_selector_obl2m_1",fe="_contenedor_obl2m_15",ke="_contenedor1_obl2m_28",Ce="_contenedor2_obl2m_37",he="_card1_obl2m_44",ve="_input_obl2m_54",je="_botonmerc_obl2m_71",u={selector:xe,contenedor:fe,contenedor1:ke,contenedor2:Ce,card1:he,input:ve,botonmerc:je};function Re(){return new Promise(function(o){o([{headerName:"Items",field:"StkItemsDesc",editable:"never"},{headerName:"Fecha ",field:"StkItemsFAct",type:"date",editable:"never"},{headerName:"Stock Mín ",field:"StkItemsMin",editable:"never"},{headerName:"Stock Máx ",field:"StkItemsMax",editable:"never"},{headerName:"Stock",field:"StkItemsCantidad",editable:"never"},{headerName:"Stock Disponible",field:"StkItemsCantDisp",editable:"never"}])})}const _e=o=>new Promise(e=>{const n=C+"/stkrubroleerprov/"+o;f.get(n).set("Content-Type","application/json").then(r=>{const l=JSON.parse(r.text);e(l)}).catch(r=>{k(r)})}),ye=()=>new Promise(o=>{const e=C+"/stkgrupoleerred";f.get(e).set("Content-Type","application/json").then(n=>{const r=JSON.parse(n.text);o(r)}).catch(n=>{k(n)})}),Pe=o=>new Promise(e=>{const n=C+"/leedatosingreso/?abr="+o;f.get(n).set("Content-Type","application/json").then(r=>{const l=JSON.parse(r.text);e(l)}).catch(r=>{k(r)})}),Ie=o=>new Promise(e=>{const n=C+"/sumaingreso";f.post(n).set("Content-Type","application/json").send({infingreso:o}).then(r=>{e(r)}).catch(r=>{k(r)})});function Ne(o){const{state:e,setState:n}=i.useContext($),[r,l]=i.useState([]),[a,b]=i.useState([]),[d,p]=i.useState(null),[m,_]=i.useState(-1),[S,y]=i.useState(0),[g,P]=i.useState(0),I=i.useRef(null),N=i.useRef(null),M=i.useRef(null);let D,h="";async function B(){const s=await ye();n({...e,stkgrupos:s})}async function J(s){const c=await _e(s);n({...e,stkrubro:c})}async function w(s){s.target.id==="cantpres"?y(s.target.value):P(s.target.value)}async function V(s){const c=s.target.id;if(n({...e,[c]:s.target.value}),_(-1),c==="StkRubroAbr"){D=s.target.value;const W=await Pe(D);b(W);const Q=await Re();l(()=>Q)}}i.useEffect(()=>{e.idStkGrupo===""&&B(),e.idStkGrupo!==""&&J(e.idStkGrupo)},[e.idStkGrupo]);const A=s=>{_(s),y(0),P(0)};async function K(){n({...e,totaling:S*g});var s=[{tingreso:S*g,abrevrubro:e.StkRubroAbr,indiceitem:a[m].idStkItems}];h=await Ie(s),a[m].StkItemsCantDisp=h.body[1][0].StkItemsCantDisp,a[m].StkItemsCantidad=h.body[1][0].StkItemsCantidad;var c=m;c<a.length-1?c++:c--,p(c),A(c)}const H=[{id:"idStkGrupo",label:"Grupo",value:e.idStkGrupo,mapeo:t.jsxs(t.Fragment,{children:[t.jsx("option",{}),e.stkgrupos.map(s=>t.jsx("option",{value:s.idStkGrupo,children:s.StkGrupoDesc},s.idStkGrupo))]})},{id:"StkRubroAbr",label:"Rubro",value:e.StkRubroAbr,mapeo:t.jsxs(t.Fragment,{children:[t.jsx("option",{}),e.stkrubro.map(s=>t.jsx("option",{value:s.StkRubroAbr,children:s.StkRubroDesc},s.StkRubroAbr))]})}];return t.jsxs("div",{className:u.contenedor,children:[t.jsxs("div",{className:u.contenedor1,children:[H.map(s=>t.jsx(v,{className:u.selector,id:s.id,size:"small",inputProps:{maxLength:3},select:!0,label:s.label,value:s.value,onChange:V,SelectProps:{native:!0},variant:"outlined",margin:"dense",children:s.mapeo},s.id)),t.jsx(oe,{rows:a,columns:r,localeText:esES.components.MuiDataGrid.defaultProps.localeText,onRowClick:(s,c)=>{p(c.tableData.id),A(c.tableData.id),setTimeout(()=>{I.current.focus()},100)}})]}),t.jsx("div",{className:u.contenedor2,children:m!==-1?t.jsx(le,{children:t.jsxs(Se,{className:u.card1,children:[t.jsxs(j,{container:!0,children:["La presentación de la mercadería es :",t.jsx("br",{}),a[0].StkRubroPresDes," de ",a[0].StkRubroPres," ",a[0].StkRubroUM,a[0].StkRubroAncho!==0&&" por "+a[0].StkRubroAncho+" "+a[m].StkItemsDesc]}),t.jsx("br",{}),t.jsx("label",{children:" Ingresaron "}),t.jsx(v,{inputProps:{maxLength:4},className:u.input,inputRef:I,size:"small",type:"number",id:"cantpres",onChange:w,value:S,autoFocus:!0,onKeyPress:s=>{s.key==="Enter"&&setTimeout(()=>{N.current.focus()},100)}}),t.jsx("label",{children:" de "}),t.jsx(v,{inputProps:{maxLength:4},className:u.input,inputRef:N,size:"small",type:"number",id:"canting",onChange:w,value:g,onKeyPress:s=>{s.key==="Enter"&&setTimeout(()=>{M.current.focus()},100)}}),t.jsxs(O,{onClick:K,ref:M,children:[" ","TOTAL INGRESADO: ",S*g]})]})}):""})]})}var R={},Me=Z;Object.defineProperty(R,"__esModule",{value:!0});var q=R.default=void 0,De=Me(Y()),we=t,Ae=(0,De.default)((0,we.jsx)("path",{d:"M19 3h-4.18C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm0 15-5-5h3V9h4v4h3l-5 5z"}),"AssignmentReturned");q=R.default=Ae;function Ge(){const[o,e]=i.useState(!1);function n(){e(!o)}return t.jsx(t.Fragment,{children:t.jsxs(j,{children:[t.jsx(O,{onClick:n,color:"primary",children:t.jsx(q,{style:{color:ee[500]},fontSize:"large",titleAccess:"Agregar"})}),o?t.jsx("div",{children:t.jsx(Ne,{})}):""]})})}const $=te.createContext();var Le=()=>{const{setValor:o}=i.useContext(se),[e,n]=i.useState(ge);return i.useEffect(()=>{o("Stock")},[]),t.jsx("div",{children:t.jsx(j,{container:!0,spacing:2,alignItems:"center",children:t.jsx($.Provider,{value:{state:e,setState:n},children:t.jsx(Ge,{})})})})};export{$ as MovStockPantContext,Le as default};
